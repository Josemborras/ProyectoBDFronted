<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HomeCinema: Registro</title>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/registro.css">
</head>
<body>
    <img src="./img/logo-homecinema.png" alt="">
    <div id="general-container">
        <div>
            <a href="./login.html"><img src="./img/flecha-atras.png" alt=""></a>
            <div>
                <div id="container-progreso">
                    <div class="progreso actual" id="paso1"></div>
                    <div class="progreso" id="paso2"></div>
                    <div class="progreso" id="paso3"></div>
                </div>
                <h2 id="pasos">Paso 1</h2>
                <p>Elige el plan que mejor se adapte a ti</p>
            </div>
        </div>
        <div>
            <div id="container-panel">
            </div>
            <div id="container-inputs">
                <form>
                    <div class="inner-input">
                        <div class="inputs">
                            <label for="correo">Correo electrónico</label>
                            <input type="email" name="correo" id="correo">
                        </div>
                        <div class="inputs">
                            <label for="nombre">Nombre</label>
                            <input type="text" name="nombre" id="nombre">
                        </div>
                    </div>
                    <div class="inner-input">
                        <div class="inputs">
                            <label for="password">Contraseña</label>
                            <input type="password" name="password" id="password">
                        </div>
                        <div class="inputs">
                            <label for="apellido_uno">Primer apellido</label>
                            <input type="text" name="apellido_uno" id="apellido_uno">
                        </div>
                    </div>
                    <div class="inner-input">
                        <div class="inputs">
                            <label for="repeat-password">Confirmar contraseña</label>
                            <input type="password" name="repeat-password" id="repeat-password">
                        </div>
                        <div class="inputs">
                            <label for="apellido_dos">Segundo apellido</label>
                            <input type="text" name="apellido_dos" id="apellido_dos">
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <button>Siguiente</button>
    </div>

    <script>
        const contenedorPanel = document.querySelector('#container-panel')
        const contenedorInputs = document.querySelector('#container-inputs')
        const pasos = document.querySelector('#pasos')
        const paso1 = document.querySelector('#paso1')
        const paso2 = document.querySelector('#paso2')
        const paso3 = document.querySelector('#paso3')
        let pagina  = 1
        const boton = document.querySelector('button')
        const enlace = document.querySelector('a')

        fetch('http://localhost:3000/planes')
            .then(res => res.json())
            .then(json => {
                const cabeceraCalidad = document.querySelector('.cabecera-calidad-plan')
                const resolucion = document.querySelector('.resolucion-plan')
                const anuncios = document.querySelector('.anuncios-plan')
                const descargas = document.querySelector('.descargas-plan')
                console.log(json)
                for(let i = 2; i>=0 ; --i){
                    contenedorPanel.innerHTML += `
                <div class="panel" onClick=ingresarDatos(${json[i].id}) onClick=>
                <div class="cabecera" id="cabecera${i}">
                    <h3>${json[i].nombre}</h3>
                    <p class="cabecera-calidad-plan">${calidadesCabecera(json[i].calidad, resolucion)}</p>
                    <img src="  ./img/tick.png">
                </div>
                <div class="inner-panel">
                    <p>Precio al mes</p>
                    <p>${json[i].precio}€</p>
                    <hr>
                </div>
                <div class="inner-panel">
                    <p>Resolución</p>
                    <p class="resolucion-plan">${calidadResolucion(json[i].calidad, resolucion)}</p>
                    <hr>
                </div>
                <div class="inner-panel">
                    <p>Anuncios</p>
                    <p class="anuncios-plan">${checkBooleanos(json[i].anuncios, anuncios)}</p>
                    <hr>
                </div>
                <div class="inner-panel">
                    <p>Número de perfiles</p>
                    <p class="perfiles-plan">${json[i].numero_perfiles}</p>
                    <hr>
                </div>
                <div class="inner-panel">
                    <p>Pantallas simultáneas</p>
                    <p class="pantallas-plan">${json[i].num_pantalla}</p>
                    <hr>
                </div>
                <div class="inner-panel">
                    <p>Descargas</p>
                    <p class="descargas-plan">${checkBooleanos(json[i].descargas, descargas)}</p>
                </div>

            </div>
                `
                }
            })
            
            boton.addEventListener('click', (e) =>{
                if(pagina == 2){

                }else{
                    e.preventDefault()
                }
                avanzarPaso()
            })

            const calidadResolucion = (dato, valor) =>{
                switch(dato){
                        case 1:
                            return "1280 x 720 (720p)"
                            break
                        case 2:
                            return "1920 x 1080 (1080p)"
                        case 3:
                            return "3840 x 2160 (4K)"
                        default:
                            return
                    }
            }

            const calidadesCabecera = (dato, valor) =>{
                switch(dato){
                        case 1:
                            return "720p"
                        case 2:
                            return "1080p"
                        case 3:
                            return "4K"
                        default:
                            return
                            
                    }
            }

            const checkBooleanos = (dato, valor) =>{
                if(dato == 1){
                        return "Sí"
                    }else{
                        return "No"
                    }
            }
            
            const ingresarDatos = (id) => {
                sessionStorage.setItem('planId', id)

            }

            const avanzarPaso = () =>{
                if(pagina <= 4){
                    ++pagina
                }

                pasos.innerHTML = `
                Paso ${pagina}
                `
                switch(pagina){
                    case 1:
                    setClase(paso1, 'actual')
                    break
                    case 2:
                    contenedorPanel.style.display = 'none'
                    contenedorInputs.style.display = 'flex'
                    setClase(paso1, 'completado')
                    deleteClass(paso1, 'actual')
                    setClase(paso2, 'actual')
                    break

                    case 3:
                    contenedorPanel.style.display = 'none'
                    contenedorInputs.style.display = 'none'
                    setClase(paso2, 'completado')
                    deleteClass(paso2, 'actual')
                    setClase(paso3, 'actual')
                    break
                    case 4:
                        --pagina
                        window.location = './login.html'
                    break
                    default: break
                }
                if(pagina <=3){
                    pasos.innerHTML = `
                Paso ${pagina}
                `
                }
            }

            const retrocederPaso = () =>{
                if(pagina >= 1){
                    --pagina
                }

                switch(pagina){
                    case 0:
                    window.location = './login.html'
                    break
                    
                    case 1:
                    contenedorPanel.style.display = 'flex'
                    contenedorInputs.style.display = 'none'
                    setClase(paso1, 'actual')
                    deleteClass(paso2, 'actual')
                    deleteClass(paso2, 'completado')
                    break

                    case 2:
                    contenedorPanel.style.display = 'none'
                    contenedorInputs.style.display = 'flex'
                    setClase(paso1, 'completado')
                    deleteClass(paso1, 'actual')
                    setClase(paso2, 'actual')
                    deleteClass(paso3, 'actual')
                    break

                    case 3:
                    contenedorPanel.style.display = 'none'
                    contenedorInputs.style.display = 'none'
                    setClase(paso2, 'completado')
                    deleteClass(paso2, 'actual')
                    setClase(paso3, 'actual')
                    break

                    default: break
                }

                if(pagina != 0){
                    pasos.innerHTML = `
                Paso ${pagina}
                `
                }
            }

            const setClase = (actual, clase) =>{
                actual.classList.add(clase)
            }

            const deleteClass = (actual, eliminar) =>{
                actual.classList.remove(eliminar)
            }

            enlace.addEventListener('click', (e) =>{
                e.preventDefault()

                retrocederPaso()
            })
    </script>
    <script src="./registro.js"></script>
</body>
</html>